-- library ieee;
-- use ieee.std_logic_1164.all;
-- use ieee.numeric_std.all;
-- use work.fixed_generic_pkg.all;

package fixed_pkg is new work.fixed_generic_pkg;
use work.fixed_pkg.all;

-- ⇩ ponovi kontekst za sledeću dizajn jedinicu
library ieee;
use ieee.std_logic_1164.all;
use ieee.numeric_std.all;
use ieee.fixed_float_types.all;
use work.fixed_pkg.all;

----------------------------------------------------------------------
entity delta_sigma is
port(
clk, rst : in std_logic;
x : in sfixed(3 downto -8);
y : out sfixed(3 downto 0)
);
end entity;
----------------------------------------------------------------------
architecture rti of delta_sigma is
	-- Coefficients of H0.
	constant b00 : sfixed(3 downto -8) := to_sfixed(7.3765809, 3, -8);
	constant a01 : sfixed(0 downto -11) := to_sfixed(0.3466036, 0, -11);
	-- Coefficients of H1.
	constant b10 : sfixed(0 downto -11) := to_sfixed(0.424071040, 0, -11);
	constant b11 : sfixed(2 downto -9) := to_sfixed(2.782608716, 2, -9);
	constant a11 : sfixed(0 downto -11) := to_sfixed(0.66591402, 0, -11);
	constant a12 : sfixed(0 downto -11) := to_sfixed(0.16260264, 0, -11);
	-- Coefficients of H2.
	constant b20 : sfixed(3 downto -8) := to_sfixed(4.606822182, 3, -8);
	constant b21 : sfixed(0 downto -11) := to_sfixed(0.023331537, 0, -11);
	constant a21 : sfixed(0 downto -11) := to_sfixed(0.62380242, 0, -11);
	constant a22 : sfixed(0 downto -11) := to_sfixed(0.4509869, 0, -11);
	
begin
	process(clk, rst)
		-- IIR’s output, quantizier input and quantization error.
		variable y_iir, e : sfixed(4 downto -19);
		variable y_i : sfixed(4 downto -19);
		-- H0.
		variable x0, x0d : sfixed(4 downto -19);
		-- H1.
		variable x1, w1, w1d, w1dd : sfixed(4 downto -19);
		-- H2.
		variable x2, w2, w2d, w2dd : sfixed(4 downto -19);
	-- Output.
	variable v : sfixed(4 downto 0);
	
	begin
	
	end process;